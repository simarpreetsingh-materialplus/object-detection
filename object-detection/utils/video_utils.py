IyB1dGlscy92aWRlb191dGlscy5weToKaW1wb3J0IGN2MgppbXBvcnQgdGVt
cGZpbGUKaW1wb3J0IG9zCmxvZ2dpbmcKZnJvbSBzY2VuZWRldGVjdCBpbXBv
cnQgb3Blbl92aWRlbywgU2NlbmVNYW5hZ2VyCmZyb20gc2NlbmVkZXRlY3Qu
ZGV0ZWN0b3JzIGltcG9ydCBDb250ZW50RGV0ZWN0b3IKCmRlZiBleHRyYWN0
X2tleV9mcmFtZXModmlkZW9fYnl0ZXMpOgogICAgdHJ5OgogICAgICAgIHdp
dGggdGVtcGZpbGUuTmFtZWRUZW1wb3JhcnlGaWxlKGRlbGV0ZT1GYWxzZSkg
YXMgdGVtcF92aWRlb19maWxlOgogICAgICAgICAgICB0ZW1wX3ZpZGVvX2Zp
bGUud3JpdGUodmlkZW9fYnl0ZXMpCiAgICAgICAgICAgIHRlbXBfdmlkZW9f
ZmlsZV9wYXRoID0gdGVtcF92aWRlb19maWxlLm5hbWUKCiAgICAgICAgdmlk
ZW9fc3RyZWFtID0gb3Blbl92aWRlbyh0ZW1wX3ZpZGVvX2ZpbGVfcGF0aCkK
ICAgICAgICBzY2VuZV9tYW5hZ2VyID0gU2NlbmVNYW5hZ2VyKCkKICAgICAg
ICBzY2VuZV9tYW5hZ2VyLmFkZF9kZXRlY3RvcihDb250ZW50RGV0ZWN0b3Io
dGhyZXNob2xkPTMwLjApKSAgIyBEZWZhdWx0IHRocmVzaG9sZCBpcyAzMC4w
CgogICAgICAgIHNjZW5lX21hbmFnZXIuZGV0ZWN0X3NjZW5lcyh2aWRlbz12
aWRlb19zdHJlYW0pCiAgICAgICAgc2NlbmVfbGlzdCA9IHNjZW5lX21hbmFn
ZXIuZ2V0X3NjZW5lX2xpc3QoKQoKICAgICAgICBrZXlfZnJhbWVzID0gW10K
ICAgICAgICBzY2VuZV90aW1lc3RhbXBzID0gW10KCiAgICAgICAgZm9yIGks
IHNjZW5lIGluIGVudW1lcmF0ZShzY2VuZV9saXN0KToKICAgICAgICAgICAg
c3RhcnQsIGVuZCA9IHNjZW5lCiAgICAgICAgICAgIG1pZHBvaW50ID0gc3Rh
cnQuZ2V0X3NlY29uZHMoKSArIChlbmQuZ2V0X3NlY29uZHMoKSAtIHN0YXJ0
LmdldF9zZWNvbmRzKCkpIC8gMgogICAgICAgICAgICB2aWRjYXAgPSBjdjIu
VmlkZW9DYXB0dXJlKHRlbXBfdmlkZW9fZmlsZV9wYXRoKQogICAgICAgICAg
ICB2aWRjYXAuc2V0KGN2Mi5DQVJfUFJPUE9TX01TRUMsIG1pZHBvaW50ICog
MTAwMCkKICAgICAgICAgICAgc3VjY2VzcywgaW1hZ2UgPSB2aWRjYXAucmVh
ZCgpCiAgICAgICAgICAgIGlmIHN1Y2Nlc3M6CiAgICAgICAgICAgICAgICBr
ZXlfZnJhbWVzLmFwcGVuZChpbWFnZSkKICAgICAgICAgICAgICAgIHNjZW5l
X3RpbWVzdGFtcHMuYXBwZW5kKChzdHIoc3RhcnQpLCBzdHIoZW5kKSkpCiAg
ICAgICAgICAgIHZpZGNhcC5yZWxlYXNlKCkKCiAgICAgICAgb3MucmVtb3Zl
KHRlbXBfdmlkZW9fZmlsZV9wYXRoKQogICAgICAgIGRlbCB2aWRlb19zdHJl
YW0KICAgICAgICByZXR1cm4ga2V5X2ZyYW1lcywgc2NlbmVfdGltZXN0YW1w
cwogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dpbmcu
ZXJyb3IoZiJFcnJvciBleHRyYWN0aW5nIGtleSBmcmFtZXM6IHtlfSIpCiAg
ICAgICAgcmV0dXJuIFtdLCBbXQ==